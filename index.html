<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Pastebin</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
* { box-sizing: border-box }
body {
  margin: 0;
  background: #0b0b0b;
  color: #f1f1f1;
  font-family: monospace;
}

/* ---------- TOP BAR ---------- */
.topbar {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 50px;
  z-index: 2000;
  display: flex;
  align-items: center;
  padding-left: 15px;
  background: #0b0b0b;
}

.menu-btn {
  font-size: 24px;
  cursor: pointer;
  user-select: none;
}

/* ---------- SIDE MENU ---------- */
.side-menu {
  position: fixed;
  top: 0;
  left: -260px;
  width: 260px;
  height: 100%;
  background: #111;
  border-right: 2px solid #222;
  padding: 60px 15px 15px;
  transition: left 0.3s ease;
  z-index: 1000;
}

.side-menu.open { left: 0 }
.side-menu h2 { margin-top:0; margin-bottom:15px }

.side-menu button {
  width: 100%;
  padding: 12px;
  margin-bottom: 10px;
  background: #1a1a1a;
  color: #fff;
  border: 1px solid #333;
  cursor: pointer;
}

.side-menu button:hover { background: #222 }

/* ---------- MAIN ---------- */
.container {
  max-width: 900px;
  margin: auto;
  padding: 70px 20px 20px;
}

h1 { text-align: center }

/* ---------- SEARCH ---------- */
.search {
  width: 100%;
  padding: 14px;
  font-size: 16px;
  background: #111;
  color: #fff;
  border: 2px solid #333;
  outline: none;
}

.section { margin-top: 25px }
.section h2 { border-bottom: 1px solid #222 }

/* ---------- PASTES ---------- */
.paste {
  padding: 12px;
  background: #111;
  border: 1px solid #222;
  margin-bottom: 8px;
  cursor: pointer;
}
.paste:hover { background: #151515 }

.hidden { display: none }

/* ---------- PASTE VIEW ---------- */
.paste-box {
  background: #111;
  border: 2px solid #222;
  padding: 15px;
  max-height: 65vh;
  overflow-y: auto;
  white-space: pre-wrap;
}

/* ---------- FORMS ---------- */
.input, textarea {
  width: 100%;
  background: #111;
  color: #fff;
  border: 2px solid #333;
  padding: 12px;
  margin-bottom: 10px;
}

textarea { min-height: 200px; resize: vertical }

.form-buttons {
  display: flex;
  gap: 10px;
}

.form-buttons button {
  flex: 1;
  padding: 12px;
  border: none;
  cursor: pointer;
}

.publish { background: #2a7 }
.clear { background: #922 }

@media (max-width: 600px) {
  textarea { min-height: 150px }
}
</style>
</head>

<body>

<div class="topbar">
  <div class="menu-btn" onclick="toggleMenu()">â˜°</div>
</div>

<div class="side-menu" id="menu">
  <h2>Menu</h2>
  <button onclick="goHome()">Home</button>
  <button onclick="openPaste()">Paste</button>
  <button id="loginBtn" onclick="openLogin()">Login</button>
  <button id="signupBtn" onclick="openSignup()">Sign up</button>
  <button id="accountBtn" class="hidden" onclick="openAccount()">My Account</button>
</div>

<div class="container">

<h1 id="pageTitle">Pastebin</h1>

<!-- HOME -->
<div id="home">
  <input class="search" placeholder="Search pastes..." oninput="search(this.value)">
  <div class="section">
    <h2>Recent Pastes</h2>
    <div id="recent"></div>
  </div>
</div>

<!-- VIEW PASTE -->
<div id="view" class="hidden">
  <div class="paste-box" id="viewContent"></div>
</div>

<!-- CREATE PASTE -->
<div id="create" class="hidden">
  <input class="input" id="pasteTitle" placeholder="Paste title">
  <textarea id="pasteText" placeholder="Paste content"></textarea>
  <div class="form-buttons">
    <button class="publish" onclick="publishPaste()">Publish</button>
    <button class="clear" onclick="clearPaste()">Clear</button>
  </div>
</div>

<!-- LOGIN PAGE -->
<div id="login" class="hidden">
  <input class="input" id="loginUser" placeholder="Username">
  <input class="input" id="loginPass" type="password" placeholder="Password">
  <div class="form-buttons">
    <button class="publish" onclick="login()">Login</button>
    <button class="clear" onclick="goHome()">Cancel</button>
  </div>
</div>

<!-- SIGNUP PAGE -->
<div id="signup" class="hidden">
  <input class="input" id="signupUser" placeholder="Username">
  <input class="input" id="signupPass" type="password" placeholder="Password">
  <div class="form-buttons">
    <button class="publish" onclick="signup()">Sign up</button>
    <button class="clear" onclick="goHome()">Cancel</button>
  </div>
</div>

<!-- ACCOUNT PAGE -->
<div id="account" class="hidden">
  <h2>My Account</h2>
  <p id="accName"></p>
  <button class="clear" onclick="logout()">Log out</button>
</div>

</div>

<script>
/* ---------- STATE ---------- */
let pastes = JSON.parse(localStorage.getItem("pastes") || "[]");
let users = JSON.parse(localStorage.getItem("users") || "{}");
let currentUser = localStorage.getItem("currentUser");

/* ---------- MENU ---------- */
function toggleMenu() {
  document.getElementById("menu").classList.toggle("open");
}

/* ---------- NAVIGATION ---------- */
function hideAll() {
  document.querySelectorAll(".container > div").forEach(d => d.classList.add("hidden"));
}

function goHome() { hideAll(); home.classList.remove("hidden") }
function openPaste() { hideAll(); create.classList.remove("hidden") }
function openLogin() { hideAll(); login.classList.remove("hidden") }
function openSignup() { hideAll(); signup.classList.remove("hidden") }
function openAccount() {
  hideAll();
  account.classList.remove("hidden");
  accName.textContent = "Logged in as: " + currentUser;
}

/* ---------- PASTE ---------- */
function publishPaste() {
  const title = pasteTitle.value.trim();
  const text = pasteText.value.trim();
  if (!title || !text) return alert("Fill everything");

  pastes.unshift({ title, text, time: Date.now() });
  localStorage.setItem("pastes", JSON.stringify(pastes));
  clearPaste();
  goHome();
  render();
}

function clearPaste() { pasteTitle.value = ""; pasteText.value = "" }

function render() {
  recent.innerHTML = "";
  pastes.forEach(p => {
    const d = document.createElement("div");
    d.className = "paste";
    d.textContent = p.title;
    d.onclick = () => {
      hideAll();
      view.classList.remove("hidden");
      viewContent.textContent = p.text;
    };
    recent.appendChild(d);
  });
}

function search(q) {
  recent.innerHTML = "";
  pastes.filter(p => p.title.toLowerCase().includes(q.toLowerCase()))
    .forEach(p => {
      const d = document.createElement("div");
      d.className = "paste";
      d.textContent = p.title;
      d.onclick = () => {
        hideAll();
        view.classList.remove("hidden");
        viewContent.textContent = p.text;
      };
      recent.appendChild(d);
    });
}

/* ---------- AUTH ---------- */
function signup() {
  if (!signupUser.value || !signupPass.value) return alert("Fill username & password");
  if (users[signupUser.value]) return alert("User exists");
  users[signupUser.value] = signupPass.value;
  localStorage.setItem("users", JSON.stringify(users));
  currentUser = signupUser.value;
  localStorage.setItem("currentUser", currentUser);
  updateAuth();
  goHome();
}

function login() {
  if (!loginUser.value || !loginPass.value) return alert("Fill username & password");
  if (users[loginUser.value] !== loginPass.value) return alert("Invalid");
  currentUser = loginUser.value;
  localStorage.setItem("currentUser", currentUser);
  updateAuth();
  goHome();
}

function logout() {
  localStorage.removeItem("currentUser");
  currentUser = null;
  updateAuth();
  goHome();
}

function updateAuth() {
  loginBtn.classList.toggle("hidden", !!currentUser);
  signupBtn.classList.toggle("hidden", !!currentUser);
  accountBtn.classList.toggle("hidden", !currentUser);
}

/* ---------- INIT ---------- */
updateAuth();
render();
</script>

</body>
</html>
